<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Template QA Tool</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<script>
  (function () {
    const PW = "VerySecret";
    const entered = prompt("Passwort:");
    if (entered !== PW) {
      document.documentElement.innerHTML = "";
    }
  })();
</script>
    <div class="container">
        <header>
            <img src="pw-logo.png" alt="PW Logo" style="width: 60px; height: 60px; margin-bottom: 15px;">
            <h1>HTML Template QA Tool</h1>
            <p>Automatische Pr√ºfung und Optimierung von E-Mail-Templates</p>
        </header>

        <main>
            <!-- Upload Section -->
            <section class="upload-section">
                <h2>1. Template hochladen</h2>
                <div class="upload-box">
                    <input type="file" id="fileInput" accept=".html,.htm" />
                    <label for="fileInput" class="upload-label">
                        <span class="upload-icon">üìÅ</span>
                        <span>HTML-Datei ausw√§hlen</span>
                    </label>
                    <div id="fileName" class="file-name"></div>
                </div>
            </section>

            <!-- Configuration Section -->
            <section class="config-section">
                <h2>2. Konfiguration</h2>
                
                <div class="form-group">
                    <label for="checklistType">Checklist-Typ:</label>
                    <select id="checklistType">
                        <option value="auto">Auto erkennen</option>
                        <option value="standard">Standard</option>
                        <option value="dpl">DPL</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="preheaderText">Preheader-Text (optional):</label>
                    <input type="text" id="preheaderText" placeholder="z.B. Ihre monatliche √úbersicht ist da!" />
                </div>

                <div class="form-group checkbox-group">
                    <input type="checkbox" id="removeFonts" checked />
                    <label for="removeFonts">Externe Fonts entfernen (Google Fonts, @import, @font-face)</label>
                </div>

                <button id="processBtn" class="btn-primary" disabled>
                    <span class="btn-icon">‚öôÔ∏è</span>
                    Template verarbeiten
                </button>
                
                <div id="uploadHint" class="upload-hint" style="display: block;">
                    ‚ö†Ô∏è Bitte zuerst eine HTML-Datei ausw√§hlen.
                </div>
            </section>

            <!-- Results Section -->
            <section id="resultsSection" class="results-section" style="display: none;">
                <h2>3. Ergebnisse</h2>
                
                <div id="statusBadge" class="status-badge"></div>
                
                <div class="download-grid">
                    <button id="downloadOptimized" class="btn-download">
                        <span class="btn-icon">üìÑ</span>
                        optimized.html
                    </button>
                    <button id="downloadReport" class="btn-download">
                        <span class="btn-icon">üìã</span>
                        report.txt
                    </button>
                    <button id="downloadUnresolved" class="btn-download">
                        <span class="btn-icon">‚ö†Ô∏è</span>
                        unresolved.txt
                    </button>
                    <!-- Phase 11: Final Output Button -->
                    <button id="downloadFinalOutput" class="btn-download btn-final-output">
                        <span class="btn-icon">‚¨áÔ∏è</span>
                        Final Output (committed)
                    </button>
                    <button id="showDiffBtn" class="btn-diff">
                        <span class="btn-icon">üìä</span>
                        √Ñnderungen anzeigen (Diff)
                    </button>
                    <button id="showTagReviewBtn" class="btn-tag-review">
                        <span class="btn-icon">üîç</span>
                        HTML-Tag-Review
                    </button>
                    <button id="showAssetReviewBtn" class="btn-asset-review">
                        <span class="btn-icon">üñºÔ∏è</span>
                        Asset und Tracking Review
                    </button>
                    <button id="showInspectorBtn" class="btn-inspector">
                        <span class="btn-icon">üîç</span>
                        Inspector
                    </button>
                </div>

                <div id="tagReviewHint" class="tag-review-hint" style="display: none;">
                    ‚ö†Ô∏è Erst Template verarbeiten, bevor Tag-Review genutzt werden kann.
                </div>

                <div id="reportPreview" class="report-preview"></div>
            </section>
        </main>

        <footer>
            <p>¬© 2026 HTML Template QA Tool | Clientseitige Verarbeitung - Keine Daten werden hochgeladen</p>
        </footer>
    </div>

    <!-- Diff Modal -->
    <div id="diffModal" class="diff-modal" style="display: none;">
        <div class="diff-modal-content">
            <div class="diff-modal-header">
                <h2>üìä √Ñnderungen zwischen Original und Optimiert</h2>
                <button id="closeDiffModal" class="close-modal">√ó</button>
            </div>
            <div class="diff-info">
                ‚ÑπÔ∏è Diese Ansicht zeigt nur √Ñnderungen. Es werden keine Anpassungen vorgenommen.
            </div>
            <!-- Phase 11 B4: Pending Hint Box (dynamisch) -->
            <div id="diffPendingHint" class="diff-pending-hint" style="display: none;">
                <strong>Hinweis:</strong> Es gibt nicht √ºbernommene √Ñnderungen. Diff zeigt den letzten √ºbernommenen Stand.
            </div>
            <div class="diff-container">
                <div class="diff-pane">
                    <h3>üìÑ Original</h3>
                    <pre id="diffOriginal" class="diff-code"></pre>
                </div>
                <div class="diff-pane">
                    <h3>‚úÖ Optimiert</h3>
                    <pre id="diffOptimized" class="diff-code"></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- Inspector Section -->
    <section id="inspectorSection" class="inspector-section" style="display: none;">
        <div class="inspector-header">
            <h2>üîç Inspector</h2>
            <!-- Phase 11: Global Finalize Button -->
            <button id="globalFinalizeBtn" class="btn-global-finalize" disabled title="Keine offenen √Ñnderungen">
                ‚úÖ Alles finalisieren & Export aktualisieren
            </button>
        </div>
        
        <!-- Tabs -->
        <div class="inspector-tabs">
            <button id="trackingTab" class="inspector-tab active" data-tab="tracking">
                <span class="tab-icon">üì°</span>
                Tracking
            </button>
            <button id="imagesTab" class="inspector-tab" data-tab="images">
                <span class="tab-icon">üñºÔ∏è</span>
                Bilder
            </button>
            <button id="tagReviewTab" class="inspector-tab" data-tab="tagreview">
                <span class="tab-icon">üîç</span>
                Tag-Review
            </button>
            <button id="editorTab" class="inspector-tab" data-tab="editor">
                <span class="tab-icon">‚úèÔ∏è</span>
                Editor
            </button>
        </div>
        
        <!-- Phase 9: Global Pending Indicator -->
        <div id="globalPendingIndicator" class="global-pending-indicator" style="display: none;">
            <div class="pending-status-chips">
                <span id="trackingStatusChip" class="status-chip status-committed">Tracking: Committed</span>
                <span id="imagesStatusChip" class="status-chip status-committed">Bilder: Committed</span>
                <span id="tagreviewStatusChip" class="status-chip status-committed">Tag-Review: Committed</span>
                <span id="editorStatusChip" class="status-chip status-committed">Editor: Committed</span>
            </div>
            <div id="pendingWarning" class="pending-warning" style="display: none;">
                ‚ö†Ô∏è <strong>Achtung:</strong> √Ñnderungen sind noch nicht √ºbernommen. Downloads verwenden den letzten √ºbernommenen Stand.
            </div>
        </div>
        
        <!-- 2-Spalten-Layout -->
        <div class="inspector-container">
            <!-- Linke Spalte: Controls -->
            <div class="inspector-controls">
                <div id="trackingPanel" class="inspector-panel active">
                    <h3>üì° Tracking & √ñffnerpixel</h3>
                    <div id="trackingContent" class="panel-content">
                        <!-- Wird dynamisch gef√ºllt -->
                    </div>
                </div>
                
                <div id="imagesPanel" class="inspector-panel" style="display: none;">
                    <h3>üñºÔ∏è Bilder</h3>
                    <div id="imagesContent" class="panel-content">
                        <!-- Wird dynamisch gef√ºllt -->
                    </div>
                </div>
                
                <div id="tagreviewPanel" class="inspector-panel" style="display: none;">
                    <h3>üîç Tag-Review</h3>
                    <div id="tagreviewContent" class="panel-content">
                        <!-- Wird dynamisch gef√ºllt -->
                    </div>
                </div>
                
                <div id="editorPanel" class="inspector-panel" style="display: none;">
                    <h3>‚úèÔ∏è Editor</h3>
                    <div id="editorContent" class="panel-content">
                        <!-- Wird dynamisch gef√ºllt -->
                    </div>
                </div>
            </div>
            
            <!-- Rechte Spalte: Preview -->
            <div class="inspector-preview">
                <div class="preview-header">
                    <h3>üëÅÔ∏è Vorschau</h3>
                    <div class="preview-disclaimer">
                        ‚ö†Ô∏è Web-Preview (nicht identisch mit Gmail/Outlook)
                    </div>
                </div>
                <div class="preview-container">
                    <iframe id="inspectorPreviewFrame" sandbox="allow-same-origin" class="inspector-preview-frame"></iframe>
                </div>
            </div>
        </div>
    </section>

    <!-- Tag-Review Modal -->
    <div id="tagReviewModal" class="tag-review-modal" style="display: none;">
        <div class="tag-review-modal-content">
            <div class="tag-review-modal-header">
                <h2>üîç HTML-Tag-Review</h2>
                <button id="closeTagReviewModal" class="close-modal">√ó</button>
            </div>
            <div class="tag-review-info">
                ‚ÑπÔ∏è Dieser Modus zeigt nicht geschlossene Tags. Sie entscheiden manuell, ob diese geschlossen werden.
            </div>
            <div class="tag-review-container">
                <div class="tag-review-problems">
                    <!-- Sticky Header -->
                    <div class="problems-header">
                        <div class="problems-header-item">
                            <h3>üö® Gefundene Probleme</h3>
                            <span id="problemsCountBadge" class="count-badge">0</span>
                        </div>
                        <div class="problems-header-item">
                            <h3>üîß Automatisch geschlossene Tags</h3>
                            <span id="autoFixesCountBadge" class="count-badge">0</span>
                        </div>
                        <div id="manualActionsCounter" class="manual-actions-counter">
                            Manuelle Aktionen: 0
                        </div>
                    </div>
                    
                    <!-- Scrollable Content -->
                    <div class="problems-content">
                        <div class="problems-section">
                            <h4 class="section-title">üö® Gefundene Probleme</h4>
                            <div id="tagProblemsList" class="problems-list">
                                <!-- Probleme werden hier dynamisch eingef√ºgt -->
                            </div>
                        </div>
                        
                        <div class="problems-section">
                            <h4 class="section-title">üîß Automatisch geschlossene Tags</h4>
                            <div id="autoFixesList" class="problems-list">
                                <!-- Auto-Fixes werden hier dynamisch eingef√ºgt -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tag-review-preview">
                    <!-- Sticky Header -->
                    <div class="preview-header">
                        <h3>üëÅÔ∏è Vorschau</h3>
                        <div class="preview-disclaimer">
                            ‚ö†Ô∏è Web-Preview (nicht identisch mit Gmail/Outlook)
                        </div>
                        <div class="preview-tabs">
                            <button id="showWebPreview" class="preview-tab active">Web-Rendering</button>
                            <button id="showCodePreview" class="preview-tab">Code-Snippet</button>
                        </div>
                    </div>
                    
                    <!-- Preview Content -->
                    <div class="preview-content">
                        <div id="webPreviewContainer" class="preview-container">
                            <iframe id="webPreviewFrame" sandbox="allow-same-origin" class="web-preview-frame"></iframe>
                        </div>
                        <div id="codePreviewContainer" class="preview-container" style="display: none;">
                            <pre id="codePreviewContent" class="code-preview-content"></pre>
                        </div>
                        <div id="changeSnippet" class="change-snippet" style="display: none;">
                            <h4>Letzte √Ñnderung:</h4>
                            <div class="snippet-before">
                                <strong>Vorher:</strong>
                                <pre id="snippetBefore"></pre>
                            </div>
                            <div class="snippet-after">
                                <strong>Nachher:</strong>
                                <pre id="snippetAfter"></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Footer-Leiste mit Aktionen -->
            <div class="tag-review-footer">
                <button id="undoLastAction" class="btn-undo" disabled>
                    <span class="btn-icon">‚Ü©Ô∏è</span>
                    Letzte √Ñnderung r√ºckg√§ngig machen
                </button>
                <button id="commitReviewChanges" class="btn-commit" disabled>
                    <span class="btn-icon">‚úÖ</span>
                    √Ñnderungen √ºbernehmen
                </button>
            </div>
        </div>
    </div>

    <!-- Asset-Review Modal -->
    <div id="assetReviewModal" class="tag-review-modal" style="display: none;">
        <div class="tag-review-modal-content">
            <div class="tag-review-modal-header">
                <h2>üñºÔ∏è Asset und Tracking Review</h2>
                <button id="closeAssetReviewModal" class="close-modal">√ó</button>
            </div>
            <div class="tag-review-info">
                ‚ÑπÔ∏è Phase C: Manuelle √úberpr√ºfung und kontrolliertes Ersetzen von Assets und Tracking-Elementen.
            </div>
            <div class="tag-review-container">
                <div class="tag-review-problems">
                    <!-- Sticky Header -->
                    <div class="problems-header">
                        <div class="problems-header-item">
                            <h3>üìù Asset und Tracking Review</h3>
                        </div>
                        <div id="assetActionsCounter" class="manual-actions-counter">
                            Manuelle Aktionen: 0
                        </div>
                    </div>
                    
                    <!-- Scrollable Content -->
                    <div class="problems-content">
                        <!-- Preheader Section -->
                        <div class="problems-section">
                            <h4 class="section-title">üì® Preheader</h4>
                            <div id="preheaderInfo" class="asset-info">
                                <!-- Preheader Info wird hier dynamisch eingef√ºgt -->
                            </div>
                        </div>
                        
                        <!-- Bilder Section -->
                        <div class="problems-section">
                            <h4 class="section-title">üñºÔ∏è Bilder</h4>
                            <div id="imagesList" class="problems-list">
                                <!-- Bilder werden hier dynamisch eingef√ºgt -->
                            </div>
                        </div>
                        
                        <!-- Links Section -->
                        <div class="problems-section">
                            <h4 class="section-title">üîó Links</h4>
                            <div id="linksList" class="problems-list">
                                <!-- Links werden hier dynamisch eingef√ºgt -->
                            </div>
                        </div>
                        
                        <!-- √ñffnerpixel/Tracking Section -->
                        <div class="problems-section">
                            <h4 class="section-title">üì° √ñffnerpixel/Tracking</h4>
                            <div id="trackingInfo" class="asset-info">
                                <!-- Tracking Info wird hier dynamisch eingef√ºgt -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tag-review-preview">
                    <!-- Sticky Header -->
                    <div class="preview-header">
                        <h3>üëÅÔ∏è Vorschau</h3>
                        <div class="preview-disclaimer">
                            ‚ö†Ô∏è Web-Preview (nicht identisch mit Gmail/Outlook)
                        </div>
                        <div class="preview-tabs">
                            <button id="showAssetWebPreview" class="preview-tab active">Web-Rendering</button>
                            <button id="showAssetCodePreview" class="preview-tab">Code-Snippet</button>
                        </div>
                    </div>
                    
                    <!-- Preview Content -->
                    <div class="preview-content">
                        <div id="assetWebPreviewContainer" class="preview-container">
                            <iframe id="assetWebPreviewFrame" sandbox="allow-same-origin" class="web-preview-frame"></iframe>
                        </div>
                        <div id="assetCodePreviewContainer" class="preview-container" style="display: none;">
                            <pre id="assetCodePreviewContent" class="code-preview-content"></pre>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Footer-Leiste mit Aktionen -->
            <div class="tag-review-footer">
                <button id="assetUndoBtn" class="btn-undo" disabled>
                    <span class="btn-icon">‚Ü©Ô∏è</span>
                    Letzte √Ñnderung r√ºckg√§ngig machen
                </button>
                <button id="assetCommitBtn" class="btn-commit" disabled>
                    <span class="btn-icon">‚úÖ</span>
                    √Ñnderungen √ºbernehmen
                </button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
